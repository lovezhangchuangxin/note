<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Polyfill 和转译器 | keqing的笔记</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/assets/images/aqing.ico">
    <meta name="description" content="study notes">
    
    <link rel="preload" href="/assets/css/0.styles.bd54a832.css" as="style"><link rel="preload" href="/assets/js/app.388e8b9b.js" as="script"><link rel="preload" href="/assets/js/2.0e0c6dfe.js" as="script"><link rel="preload" href="/assets/js/19.ba9051dc.js" as="script"><link rel="prefetch" href="/assets/js/10.b70e4572.js"><link rel="prefetch" href="/assets/js/11.6eabacae.js"><link rel="prefetch" href="/assets/js/12.0c30d09b.js"><link rel="prefetch" href="/assets/js/13.73880b75.js"><link rel="prefetch" href="/assets/js/14.b810035e.js"><link rel="prefetch" href="/assets/js/15.c4b0bfec.js"><link rel="prefetch" href="/assets/js/16.b884542e.js"><link rel="prefetch" href="/assets/js/17.8114bc4a.js"><link rel="prefetch" href="/assets/js/18.68a92e69.js"><link rel="prefetch" href="/assets/js/20.45d76f45.js"><link rel="prefetch" href="/assets/js/21.0a0bc75d.js"><link rel="prefetch" href="/assets/js/22.0a704e63.js"><link rel="prefetch" href="/assets/js/23.1f5c133a.js"><link rel="prefetch" href="/assets/js/24.8fe89294.js"><link rel="prefetch" href="/assets/js/25.050a0cb9.js"><link rel="prefetch" href="/assets/js/26.5528b268.js"><link rel="prefetch" href="/assets/js/27.8e830639.js"><link rel="prefetch" href="/assets/js/28.8ab3042c.js"><link rel="prefetch" href="/assets/js/29.f24a270d.js"><link rel="prefetch" href="/assets/js/3.d9067db4.js"><link rel="prefetch" href="/assets/js/30.8b079fe7.js"><link rel="prefetch" href="/assets/js/4.2557b634.js"><link rel="prefetch" href="/assets/js/5.89fe225c.js"><link rel="prefetch" href="/assets/js/6.497c19f1.js"><link rel="prefetch" href="/assets/js/7.5dd6fcb5.js"><link rel="prefetch" href="/assets/js/8.a02f3650.js"><link rel="prefetch" href="/assets/js/9.522e0447.js">
    <link rel="stylesheet" href="/assets/css/0.styles.bd54a832.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/images/aqing.png" alt="keqing的笔记" class="logo"> <span class="site-name can-hide">keqing的笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/guide/" class="nav-link">
  引导
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/web/CSS/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/web/JS/" class="nav-link router-link-active">
  Javascript
</a></li><li class="dropdown-item"><!----> <a href="/web/Git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/web/NodeJs/" class="nav-link">
  NodeJs
</a></li><li class="dropdown-item"><!----> <a href="/web/React/" class="nav-link">
  React
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="HUST" class="dropdown-title"><span class="title">HUST</span> <span class="arrow down"></span></button> <button type="button" aria-label="HUST" class="mobile-dropdown-title"><span class="title">HUST</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/hust/network/" class="nav-link">
  network
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/guide/" class="nav-link">
  引导
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/web/CSS/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/web/JS/" class="nav-link router-link-active">
  Javascript
</a></li><li class="dropdown-item"><!----> <a href="/web/Git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/web/NodeJs/" class="nav-link">
  NodeJs
</a></li><li class="dropdown-item"><!----> <a href="/web/React/" class="nav-link">
  React
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="HUST" class="dropdown-title"><span class="title">HUST</span> <span class="arrow down"></span></button> <button type="button" aria-label="HUST" class="mobile-dropdown-title"><span class="title">HUST</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/hust/network/" class="nav-link">
  network
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/web/" aria-current="page" class="sidebar-link">web 前端相关知识</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/web/CSS/" class="sidebar-heading clickable"><span>CSS</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/web/JS/" class="sidebar-heading clickable router-link-active open"><span>JavaScript</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/web/JS/this理解.html" class="sidebar-link">this理解</a></li><li><a href="/web/JS/改变this指向.html" class="sidebar-link">改变this指向</a></li><li><a href="/web/JS/Polyfill和转译器.html" class="active sidebar-link">Polyfill和转译器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web/JS/Polyfill和转译器.html#转译器-transpilers" class="sidebar-link">转译器（Transpilers）</a></li><li class="sidebar-sub-header"><a href="/web/JS/Polyfill和转译器.html#polyfill" class="sidebar-link">Polyfill</a></li><li class="sidebar-sub-header"><a href="/web/JS/Polyfill和转译器.html#注意" class="sidebar-link">注意</a></li></ul></li><li><a href="/web/JS/学习Ajax.html" class="sidebar-link">学习Ajax</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/web/Git/" class="sidebar-heading clickable"><span>Git</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/web/NodeJs/" class="sidebar-heading clickable"><span>NodeJs</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/web/React/" class="sidebar-heading clickable"><span>React</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="polyfill-和转译器"><a href="#polyfill-和转译器" class="header-anchor">#</a> Polyfill 和转译器</h1> <details class="custom-block details"><summary>参考资料</summary> <ul><li><a href="https://zh.javascript.info/polyfills" target="_blank" rel="noopener noreferrer">现代 JavaScript 教程：Polyfill 和转译器<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.csdn.net/YeShenLiaoSuiFeng/article/details/79266911" target="_blank" rel="noopener noreferrer">JavaScript 中的 shim 和 polyfill 是什么<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.dandelioncloud.cn/article/details/1506259417409613826" target="_blank" rel="noopener noreferrer">JavaScript 术语：shim 和 polyfill<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></details> <p>JavaScript 语言在稳步发展。也会定期出现一些对语言的新提议，它们会被分析讨论，如果认为有价值，就会被加入到 (https://tc39.github.io/ecma262/)[https://tc39.github.io/ecma262/] 的列表中，然后被加到 <a href="http://www.ecma-international.org/publications/standards/Ecma-262.htm" target="_blank" rel="noopener noreferrer">ECMA 规范<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 中。</p> <p>然而，JavaScript 引擎背后的团队并不会立即实现标准中的全部内容，一个 JavaScript 引擎只能实现标准中的一部分是很常见的情况。</p> <p>如何让我们现代的代码在还不支持最新特性的旧引擎上工作？Polyfill 和转译器应运而生。</p> <h2 id="转译器-transpilers"><a href="#转译器-transpilers" class="header-anchor">#</a> 转译器（Transpilers）</h2> <blockquote><p>是一种可以将源码转译成另一种源码的特殊的工具。它可以解析（“阅读和理解”）现代代码，并使用旧的语法结构对其进行重写，进而使其也可以在旧的引擎中工作。</p></blockquote> <p>这处应联想到 <a href="https://www.babeljs.cn/docs/" target="_blank" rel="noopener noreferrer">babel<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>一个典型的例子：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 在运行转译器之前</span>
height <span class="token operator">=</span> height <span class="token operator">??</span> <span class="token number">100</span><span class="token punctuation">;</span>

<span class="token comment">// 在运行转译器之后</span>
height <span class="token operator">=</span> height <span class="token operator">!==</span> <span class="token keyword">undefined</span> <span class="token operator">&amp;&amp;</span> height <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">?</span> height <span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>在 ES2020 之前没有“空值合并运算符” ??。所以，如果访问者使用过时了的浏览器访问我们的网页，那么该浏览器可能就不明白 height = height ?? 100 这段代码的含义。</p> <p>转译器会分析我们的代码，并将 height ?? 100 重写为 (height !== undefined &amp;&amp; height !== null) ? height : 100。</p> <h2 id="polyfill"><a href="#polyfill" class="header-anchor">#</a> Polyfill</h2> <p>除了 polyfill，shim 这个词也经常被提及，我们来看它们的联系与区别。</p> <p>shim 是一个库,它将一个新的 API 引入到一个旧的环境中,而且仅靠旧环境中已有的手段实现</p> <p>polyfill 就是一个 <strong>用在浏览器 API</strong> 上的 shim.我们通常的做法是先检查当前浏览器是否支持某个 API,如果不支持的话就加载对应的 polyfill.然后新旧浏览器就都可以使用这个 API 了.（注： 术语 polyfill 来自于一个家装产品 Polyfilla）</p> <p>Polyfilla 是一个英国产品,在美国称之为 Spackling Paste(译者注:刮墙的,在中国称为腻子).记住这一点就行:把旧的浏览器想象成为一面有了裂缝的墙.这些[polyfills]会帮助我们把这面墙的裂缝抹平,还我们一个更好的光滑的墙壁(浏览器)</p> <p>一个典型的例子是：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Math<span class="token punctuation">.</span>trunc<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 如果没有这个函数</span>
  <span class="token comment">// 实现它</span>
  Math<span class="token punctuation">.</span><span class="token function-variable function">trunc</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Math.ceil 和 Math.floor 甚至存在于上古年代的 JavaScript 引擎中</span>
    <span class="token comment">// 在本教程的后续章节中会讲到它们</span>
    <span class="token keyword">return</span> number <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">?</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span> <span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>Math.trunc(n) 是一个“截断”数字小数部分的函数，例如 Math.trunc(1.23) 返回 1。</p> <p>在一些（非常过时的）JavaScript 引擎中没有 Math.trunc 函数，所以这样的代码会执行失败。</p> <p>更新/添加新函数的脚本被称为“polyfill”。它“填补”了空白并添加了缺失的实现。</p> <p>对于这种特殊情况，Math.trunc 的 polyfill 是一个实现它的脚本</p> <h2 id="注意"><a href="#注意" class="header-anchor">#</a> 注意</h2> <p>Transpilers 和 polyfill 有区别，前者将现代的语法和运算符转换为旧环境所支持的版本，后者是补充或者更新现代的函数。
Babel 中同时实现了 Transpilers 和 polyfill</p> <!----></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">1 个月</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/web/JS/改变this指向.html" class="prev">
        改变this指向
      </a></span> <span class="next"><a href="/web/JS/学习Ajax.html">
        学习Ajax
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.388e8b9b.js" defer></script><script src="/assets/js/2.0e0c6dfe.js" defer></script><script src="/assets/js/19.ba9051dc.js" defer></script>
  </body>
</html>
